{% macro render_messages() %}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show alert-half"
                     role="alert">
                    {{ message }}
                    <button type="button"
                            class="btn-close"
                            data-bs-dismiss="alert"
                            aria-label="Fechar"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}
{% endmacro %}

{% macro render_toast_messages() %}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {# Container de toasts no canto superior direito #}
            <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 11000;">
                {% for category, message in messages %}
                    {# Mapeia categorias de flash para cores de toast do Bootstrap #}
                    {% if category == 'danger' %}
                        {% set bg_class = 'bg-danger-subtle text-white' %}
                        {% set icon = '‚ùå' %}
                    {% elif category == 'warning' %}
                        {% set bg_class = 'bg-warning-subtle text-dark' %}
                        {% set icon = '‚ö†Ô∏è' %}
                    {% elif category == 'success' %}
                        {% set bg_class = 'bg-success-subtle text-white' %}
                        {% set icon = '‚úÖ' %}
                    {% elif category == 'info' %}
                        {% set bg_class = 'bg-info-subtle text-dark' %}
                        {% set icon = '‚ÑπÔ∏è' %}
                    {% else %}
                        {% set bg_class = 'bg-secondary text-white' %}
                        {% set icon = 'üí¨' %}
                    {% endif %}

                    <div class="toast {{ bg_class }}" role="alert" aria-live="assertive" aria-atomic="true"
                         data-bs-autohide="{% if category not in ['danger', 'warning'] %}true{% else %}false{% endif %}"
                         data-bs-delay="5000">
                        <div class="toast-header {{ bg_class }}">
                            <strong class="me-auto">{{ icon }} Notifica√ß√£o</strong>
                            <button type="button" class="btn-close {% if category in ['success', 'danger'] %}btn-close-white{% endif %}"
                                    data-bs-dismiss="toast" aria-label="Fechar"></button>
                        </div>
                        <div class="toast-body">
                            {{ message }}
                        </div>
                    </div>
                {% endfor %}
            </div>

            {# Script para mostrar os toasts automaticamente #}
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    var toastElList = [].slice.call(document.querySelectorAll('.toast'));
                    var toastList = toastElList.map(function(toastEl) {
                        var toast = new bootstrap.Toast(toastEl);
                        toast.show();
                        return toast;
                    });
                });
            </script>
        {% endif %}
    {% endwith %}
{% endmacro %}
