{% from 'bootstrap5/form.html' import render_form, render_field %}
{% from 'bootstrap5/utils.html' import render_icon %}
{% extends "_layout.jinja2" %}

{% block content %}
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-sm-12 col-md-12 col-lg-10 col-xl-8 col-xxl-6">
                <form method="POST" enctype="multipart/form-data" novalidate>
                    {{ form.csrf_token() }}
                    {{ form.id() }}
                    <div class="card shadow-lg my-5">
                        <div class="card-header px-5 py-4">
                            <h2 class="fw-bold mb-4 card-title">{{ title_card }}</h2>
                        </div>
                        <div class="card-body px-5 py-4">
                            <div class="row">
                                {% if current_user.com_foto %}
                                {# Coluna da foto - só aparece se usuário tem foto #}
                                <div class="col-md-4 text-center mb-3">
                                    <img src="{{ url_for('auth.foto', user_id=current_user.id, _external=False) }}?v={{ current_user.updated_at.timestamp() if current_user.updated_at else '' }}"
                                         class="img-fluid rounded mb-3"
                                         alt="Foto de perfil"
                                         style="max-width: 100%;">
                                    <div class="form-check">
                                        {{ form.remover_foto(class="form-check-input") }}
                                        {{ form.remover_foto.label(class="form-check-label") }}
                                    </div>
                                </div>
                                {% endif %}

                                {# Coluna dos dados #}
                                <div class="col-md-{{ '8' if current_user.com_foto else '12' }}">
                                    <div class="mb-3">
                                        {{ render_field(form.nome) }}
                                    </div>

                                    <div class="mb-3">
                                        {{ form.email.label(class="form-label text-muted") }}
                                        <div class="input-group">
                                            <span class="input-group-text">{{ render_icon('lock-fill') }}</span>
                                            {{ form.email(class="form-control", readonly=true, style="background-color: #f8f9fa; color: #6c757d;") }}
                                        </div>
                                        <div class="form-text text-muted">
                                            <small>O email não pode ser alterado</small>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        {{ render_field(form.foto) }}
{#                                        <small class="form-text text-muted">#}
{#                                            Formatos aceitos: PNG, JPG, JPEG, WEBP. Tamanho máximo: 5MB.#}
{#                                        </small>#}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer px-5 py-3 d-flex justify-content-end">
                            {{ render_field(form.submit, button_style='primary', button_size='md') }}
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}
